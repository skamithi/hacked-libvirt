From: Ubuntu Developers <ubuntu-devel-discuss@lists.ubuntu.com>
Date: Wed, 5 Aug 2015 02:00:56 -0400
Subject: 9032-virsh-initialize-vsh-data-in-cmdmigrate
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

commit c285ffc4c2f042941acc44406bdd442252d1b0aa
Author: JÃ¡n Tomko <jtomko@redhat.com>
Date:   Tue Aug 26 13:18:43 2014 +0200

    virsh: Initialize vshData in cmdMigrate
    
    If the virConnect did not succeeed, we called
    virConnectClose on uninitialized data.
    
    Introduced by commit 7eabd55.
---
 tools/virsh-domain.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/tools/virsh-domain.c b/tools/virsh-domain.c
index 9f23c25..38aaa56 100644
--- a/tools/virsh-domain.c
+++ b/tools/virsh-domain.c
@@ -8817,7 +8817,7 @@ cmdMigrate(vshControl *ctl, const vshCmd *cmd)
     bool functionReturn = false;
     int timeout = 0;
     bool live_flag = false;
-    vshCtrlData data;
+    vshCtrlData data = { .dconn = NULL };
 
     if (!(dom = vshCommandOptDomain(ctl, cmd, NULL)))
         return false;
